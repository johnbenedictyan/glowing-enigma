generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "sqlite"
    url      = "file:./dev.db"
}

model User {
    id              Int        @id @default(autoincrement())
    name            String
    purchaseHistory Purchase[]
    cashBalance     Decimal
}

model Restaurant {
    name         String  @id
    openingHours String
    menu         Dish[]
    cashBalance  Decimal
}

model Dish {
    name           String
    price          Decimal
    Restaurant     Restaurant @relation(fields: [restaurantName], references: [name])
    Purchase       Purchase[]
    restaurantName String

    @@unique([name, restaurantName])
}

model Purchase {
    User               User     @relation(fields: [userId], references: [id])
    userId             Int
    Dish               Dish     @relation(fields: [dishName, dishRestaurantName], references: [name, restaurantName])
    dishName           String
    dishRestaurantName String
    transactionAmount  Decimal
    transactionDate    DateTime

    @@unique([userId, dishName, dishRestaurantName, transactionDate])
}
