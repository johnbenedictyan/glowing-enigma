generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "sqlite"
    url      = "file:./dev.db"
}

model User {
    id              Int        @id @default(autoincrement())
    name            String
    purchaseHistory Purchase[]
    cashBalance     Decimal
}

model Restaurant {
    id           Int     @id @default(autoincrement())
    name         String  @unique
    openingHours String
    menu         Dish[]
    cashBalance  Decimal
}

model Dish {
    name         String
    price        Decimal
    Restaurant   Restaurant @relation(fields: [restaurantId], references: [id])
    restaurantId Int
    Purchase     Purchase[]

    @@unique([name, restaurantId])
}

model Purchase {
    User             User     @relation(fields: [userId], references: [id])
    userId           Int
    Dish             Dish     @relation(fields: [dishName, dishRestaurantId], references: [name, restaurantId])
    dishName         String
    dishRestaurantId Int
    transactionDate  DateTime

    @@unique([userId, dishName, dishRestaurantId, transactionDate])
}
